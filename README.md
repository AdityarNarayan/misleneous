
Header
 Header
 Header

 Header
 
 
 
 
If Not invalid Then
    If Len(w) >= 2 Then
        ' Only treat as ALPHANUM_ID if first char is a letter and all others are digits, and ONLY if length = 2 (1 letter + digits)
        If Mid$(w, 1, 1) Like "[A-Za-z]" And _
           Mid$(w, 2) Like String(Len(w) - 1, "#") And _
           Len(w) = 1 + Len(Mid$(w, 2)) Then
            ' Make sure there is only one letter at the start
            Category = 5 'ALPHANUM_ID
            Exit Function
        End If
    End If
End If



' Code Generated by Sidekick is for learning and experimentation purposes only.
Private Function EntityChunk(tok() As String, ub As Long) As String
    Dim keep() As String
    Dim k As Long: k = 0
    Dim i As Long
    Dim w As String

    ReDim keep(0 To ub) ' Pre-size to max possible tokens

    For i = 0 To ub
        w = tok(i)
        Select Case Category(w)
            Case 1 ' ALPHA
                keep(k) = w: k = k + 1
            Case 2 ' SHORTNUM
                If i < ub Then
                    If Category(tok(i + 1)) = 1 Then
                        keep(k) = w: k = k + 1
                    Else
                        Exit For
                    End If
                Else
                    Exit For
                End If
            Case Else ' 3, 4, 5: LONGNUM, NONALNUM, ALPHANUM_ID
                Exit For
        End Select
    Next i

    If k > 0 Then
        EntityChunk = Join(Application.WorksheetFunction.Index(keep, Evaluate("ROW(1:" & k & ")")), " ")
    Else
        EntityChunk = ""
    End If
End Function

            Category = 3 'LONGNUM
        End If
    Else
        Category = 1 'ALPHA
    End If
End Function

