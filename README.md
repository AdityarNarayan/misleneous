' Code Generated by Sidekick is for learning and experimentation purposes only.
Sub Extract_Upto_First_UnwantedWord_Safe()

    Dim ws          As Worksheet
    Dim lastRow     As Long
    Dim r           As Long
    Dim txt         As String
    Dim parts()     As String
    Dim cleaned     As String
    Dim i           As Long
    
    Dim reHasLetter As Object    ' at least one Aâ€“Z
    Dim reDigits    As Object    ' digits only
    Dim reNonAlnum  As Object    ' contains any non-alphanumeric
    
    '--- Init
    Set ws = ThisWorkbook.Worksheets(1)                    'adjust sheet
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    Set reHasLetter = CreateObject("VBScript.RegExp")
    reHasLetter.Pattern = "[A-Za-z]"
    
    Set reDigits = CreateObject("VBScript.RegExp")
    reDigits.Pattern = "^\d+$"
    
    Set reNonAlnum = CreateObject("VBScript.RegExp")
    reNonAlnum.Pattern = "[^A-Za-z0-9]"
    
    '--- Main loop
    For r = 2 To lastRow                                   'assumes header in row 1
        txt = Trim(ws.Cells(r, "A").Value & "")            'force string, avoid Null
        cleaned = ""
        
        If Len(txt) > 0 Then
            parts = Split(txt, " ")
            
            For i = LBound(parts) To UBound(parts)
                
                ' If parts(i) is empty (caused by double-spaces) just skip it
                If Len(parts(i)) = 0 Then GoTo NextWord
                
                ' (1) word has non-alphanumerics  -> STOP before this word
                If reNonAlnum.Test(parts(i)) Then Exit For
                
                ' (2) word has at least one letter -> KEEP
                If reHasLetter.Test(parts(i)) Then
                    cleaned = cleaned & parts(i) & " "
                    GoTo NextWord
                End If
                
                ' (3) word is digits-only
                If reDigits.Test(parts(i)) Then
                    ' Keep numeric word only if there is a *next* real word
                    '     and that next word contains a letter
                    If i < UBound(parts) Then
                        Dim nxt As String
                        nxt = parts(i + 1)
                        ' Skip possible empty next word (double-space)
                        Do While i + 1 <= UBound(parts) And Len(nxt) = 0
                            i = i + 1
                            If i + 1 <= UBound(parts) Then nxt = parts(i + 1) Else nxt = ""
                        Loop
                        
                        If i + 1 <= UBound(parts) And reHasLetter.Test(nxt) Then
                            cleaned = cleaned & parts(i) & " "
                            GoTo NextWord
                        End If
                    End If
                    Exit For     ' numeric not followed by letter-word -> STOP
                End If
                
NextWord:
            Next i
        End If
        
        ws.Cells(r, "B").Value = Trim(cleaned)
        ws.Cells(r, "C").Value = UCase(Trim(cleaned))      'optional
        
    Next r
    
    MsgBox "Extraction complete!", vbInformation

End Sub
